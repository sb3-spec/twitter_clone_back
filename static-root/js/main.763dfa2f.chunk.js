(this.webpackJsonpworse_twitter=this.webpackJsonpworse_twitter||[]).push([[0],[,,,,,,,,,function(e,t,n){},,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(6),r=n.n(s),o=n(2);var i=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),c=0;c<n.length;c++){var a=n[c].trim();if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t};function l(e,t,n,c){var a;c&&(a=JSON.stringify(c));var s=new XMLHttpRequest,r="http://localhost:8000/api".concat(t),o=i("csrftoken");s.responseType="json",s.open(e,r),s.setRequestHeader("Content-Type","application/json"),o&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-CSRFToken",o)),s.onload=function(){403===s.status&&(-1===window.location.href.indexOf("login")&&(window.location.href="/login?showLoginRequired=true"));n(s.response,s.status)},s.onerror=function(){n({message:"The request was an error"},400)},s.send(a)}function u(e,t,n){var c="/tweets/";e&&(c+="?username=".concat(e)),null!==n&&void 0!==n&&(c=n.replace("http://localhost:8000/api","")),l("GET",c,t)}function d(e,t,n){var c="/tweets/feed/";null!==n&&void 0!==n&&(c=n.replace("http://localhost:8000/api","")),l("GET",c,t,{username:e})}function j(e,t,n,c){l("POST","/tweets/action/",n,{id:e,action:t,username:c})}function b(e,t){var n="/tweets/data/";t&&(n+="".concat(t)),l("GET",n,e)}var f=n(1),w=function(e){var t=e.user;return Object(f.jsx)("span",{className:"px-3 py-2 my-2 rounded-circle bg-dark text-white",children:t?t.username[0]:"a"})},O=function(e){var t=e.user;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("span",{className:"pointer",onClick:function(e){e.stopPropagation(),window.location.href="/profiles/".concat(t&&t.username)},children:["@",t?t.username:"deleted_account"]})})};n(17);var m=function(e){var t=e.tweet,n=e.currentUser,a=e.setIsDeleted,s=Object(c.useState)(!1),r=Object(o.a)(s,2),i=r[0],u=r[1],d=Object(c.useState)([]),j=Object(o.a)(d,2),b=j[0],w=j[1],O=Object(c.createRef)();function m(e){var c=e.content,s=function(e,t){200===t&&a(!0)};return Object(f.jsx)("div",{className:"option",onClick:function(e){e.preventDefault(),e.stopPropagation(),u(!1),"Delete Tweet"===c&&function(e,t,n){var c="/tweets/";t&&(c+="".concat(t,"/delete/")),l("POST",c,e,{username:n})}(s,t.id,n)},children:Object(f.jsx)("p",{className:"option__content",children:c})})}return window.addEventListener("mousedown",(function(e){O.current&&!O.current.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),u(!1))})),Object(c.useEffect)((function(){t.user&&(t.user.username!==n?w(["Report Tweet","Block @".concat(t.user.username),"Follow @".concat(t.user.username)]):w(["Delete Tweet","Pin to profile"]))}),[w,n,t.user]),i?Object(f.jsx)("div",{className:"modal__background",children:Object(f.jsx)("div",{className:"options-btn__toggled",ref:O,children:b.map((function(e){return Object(f.jsx)(m,{content:e,currentUser:n})}))})}):Object(f.jsx)("div",{onClick:function(e){e.stopPropagation(),e.preventDefault(),u(!0)},className:"options-btn__untoggled",children:Object(f.jsx)("i",{className:"fas fa-ellipsis-h options-icon"})})};n(18);var p=function e(t){var n=t.tweet,a=t.callback,s=t.className,r=t.currentUser,i=(t.nextUrl,Object(c.useState)(!1)),l=Object(o.a)(i,2),u=l[0],d=l[1],p=Object(c.useState)(!1),v=Object(o.a)(p,2),x=v[0],h=v[1],N=Object(c.useState)(n.likes?n.likes:0),k=Object(o.a)(N,2),g=k[0],T=k[1],S=Object(c.useState)(!1),_=Object(o.a)(S,2),D=_[0],E=_[1],R=function(e){e.preventDefault(),e.stopPropagation(),window.location.href="/".concat(n.id)},y=function(e,t){403===t?window.location.href="/login/":404!==t&&b(P,n.id)};function U(e,t){t.stopPropagation(),t.preventDefault();var c=e;if("like"===e)u&&(c="unlike");else if("retweet"===e&x)return;j(n.id,c,y)}var C=function(t){var c=t.callback;return n.parent?Object(f.jsxs)("div",{onClick:function(e){return R(e)},children:[Object(f.jsxs)("p",{className:"retweet-header",children:["retweeted by ",Object(f.jsx)(O,{user:n.user})]}),Object(f.jsx)(e,{tweet:n.parent,callback:c,className:n.content?"retweet":"retweet no-border",currentUser:r})]}):null},P=function(e,t){200===t?(console.log(e),h(e.didRetweet),d(e.didLike),T(e.likes),0===e.likes&&d(!1)):console.log(e,t)};return Object(c.useEffect)((function(){b(P,n.id)}),[u,x,g]),!D&&(n.content||n.parent)&&Object(f.jsxs)("div",{className:s+" overall-container",onClick:function(e){return R(e)},children:[!n.parent&&Object(f.jsxs)("div",{className:"profile-container d-flex",children:[Object(f.jsx)("div",{className:"mx-1 profile-picture",children:Object(f.jsx)(w,{user:n.user})}),Object(f.jsx)("p",{className:"tweet-header",children:Object(f.jsx)(O,{user:n.user})}),Object(f.jsx)(m,{tweet:n,currentUser:r,setIsDeleted:E})]}),Object(f.jsxs)("div",{className:"tweet-container",children:[""!==n.content&&Object(f.jsx)("div",{className:"tweet-content-wrapper",children:Object(f.jsx)("p",{className:"tweet-text",children:"".concat(n.content)})}),n.parent?Object(f.jsx)("div",{className:"retweet-container",children:Object(f.jsx)(C,{callback:a})}):Object(f.jsxs)("div",{className:"buttons",children:[Object(f.jsx)("i",{className:x?"fas fa-retweet btn-icon rt-icon text-green":"fas fa-retweet btn-icon rt-icon",onClick:function(e){return U("retweet",e)}}),Object(f.jsxs)("div",{className:"like-btn__container",children:[Object(f.jsx)("i",{className:u?"fas fa-heart btn-icon like-icon red-text":"far fa-heart btn-icon like-icon",onClick:function(e){return U("like",e)}}),g]})]})]})]})};n(19);var v=function(e){var t=e.tweetId,n=Object(c.useState)(!1),a=Object(o.a)(n,2),s=a[0],r=a[1],i=Object(c.useState)(null),u=Object(o.a)(i,2),d=u[0],j=u[1],b=Object(c.useState)(0),w=Object(o.a)(b,2),O=(w[0],w[1],Object(c.useState)(!1)),m=Object(o.a)(O,2),v=(m[0],m[1],Object(c.useState)(!1)),x=Object(o.a)(v,2),h=(x[0],x[1],function(e,t){200===t?(j(e),console.log(e)):alert("There was an error finding your tweet. Please try again.")});return Object(c.useEffect)((function(){!1===s&&(!function(e,t){var n="/tweets/";e&&(n+="".concat(e)),l("GET",n,t)}(t,h),r(!0))}),[r,t,s]),null!==d&&Object(f.jsx)("div",{className:"detail-container",children:Object(f.jsx)("div",{className:"d-flex",children:Object(f.jsx)("div",{className:"col-11",children:Object(f.jsx)(p,{tweet:d})})})})},x=n(4),h=(n(20),n(10));n(22);var N=function(e){var t=Object(c.useRef)(""),n=function(t,n){var c=Object(x.a)(e.newTweets);201===n?(c.unshift(t),e.setNewTweets(c),u(e.username,e.callback)):alert("An error has occurred. Please try again")},a=function(c){c.preventDefault();var a,s,r,o=t.current.value;a=o,s=n,r=e.username,l("POST","/tweets/create/",s,{content:a,username:r}),t.current.value=""};return Object(f.jsx)("div",{className:"tweet-form-container",children:Object(f.jsx)("div",{className:"form_container",children:Object(f.jsxs)("form",{onSubmit:function(e){return a(e)},children:[Object(f.jsx)("textarea",{ref:t,required:!0,className:"form-control"}),Object(f.jsx)(h.a,{variant:"primary",children:"Tweet"})]})})})},k=(n(9),function(e){var t=e.newTweets,n=e.setNewTweets,a=e.tweets,s=e.setTweets,r=e.username,o=e.tweetsDidSet,i=e.callback,l=e.nextUrl,u=e.handleLoadNextResponse;return Object(c.useEffect)((function(){t.length>0&&(s([].concat(Object(x.a)(t),Object(x.a)(a))),n([]))}),[t]),Object(c.useEffect)((function(){!1===o&&d(r,i)}),[o,r,i]),Object(f.jsxs)("div",{className:"tweet_feed__container",children:[a.map((function(e,t){return Object(f.jsx)(p,{tweet:e,idx:t,callback:i,currentUser:r,nextUrl:l},"".concat(t,"-{tweet.id}"))})),null!==l&&Object(f.jsx)("button",{className:"btn btn-outline btn-primary",onClick:function(e){e.preventDefault(),null!==l&&d(r,u,l)},children:"Load More"})]})}),g=function(e){var t=e.newTweets,n=e.setNewTweets,a=e.tweets,s=e.setTweets,r=e.username,o=e.tweetsDidSet,i=e.callback,l=e.nextUrl,d=e.handleLoadNextResponse;return Object(c.useEffect)((function(){t.length>0&&(s([].concat(Object(x.a)(t),Object(x.a)(a))),n([]))}),[t,a,s,n]),Object(c.useEffect)((function(){!1===o&&u(r,i)}),[o,r,i]),Object(f.jsxs)("div",{className:"tweet_feed__container",children:[a.map((function(e,t){return Object(f.jsx)(p,{tweet:e,idx:t,callback:i,currentUser:r},"".concat(t,"-{tweet.id}"))})),null!==l&&Object(f.jsx)("button",{className:"btn btn-outline btn-primary",onClick:function(e){e.preventDefault(),null!==l&&u(r,d,l)},children:"Load More"})]})};var T=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)([]),r=Object(o.a)(s,2),i=r[0],u=r[1],d=Object(c.useState)(!1),j=Object(o.a)(d,2),b=j[0],w=j[1],O=Object(c.useState)(),m=Object(o.a)(O,2),p=m[0],v=m[1],h=Object(c.useState)(),T=Object(o.a)(h,2),S=T[0],_=T[1];function D(e,t){200===t?(u(e.results),w(!0),v(e.next)):alert("There was an error")}var E=function(e,t){if(200===t){var n=Object(x.a)(i).concat(e.results);u(n),v(e.next)}else alert("There was an error")},R=function(e,t){_(e.username)};return Object(c.useEffect)((function(){l("GET","/users/auth/",R)}),[]),Object(f.jsx)("div",{className:"home-container",children:Object(f.jsxs)("div",{className:"twitter_feed",children:[Object(f.jsx)(N,{username:S,newTweets:n,setNewTweets:a,tweets:i,setTweets:u,tweetsDidSet:b,callback:D}),S?Object(f.jsx)(k,{newTweets:n,setNewTweets:a,tweets:i,setTweets:u,username:S,tweetsDidSet:b,setTweetsDidSet:w,callback:D,nextUrl:p,handleLoadNextResponse:E}):Object(f.jsx)(g,{newTweets:n,setNewTweets:a,tweets:i,setTweets:u,username:S,tweetsDidSet:b,setTweetsDidSet:w,callback:D,nextUrl:p,handleLoadNextResponse:E})]})})},S=a.a.createElement,_=document.getElementById("root");_&&r.a.render(Object(f.jsx)(T,{}),_);var D=document.getElementById("global_tweets");D&&r.a.render(Object(f.jsx)(g,{}),D);var E=document.getElementById("tweet_feed");if(E){var R=S(k,E.dataset);r.a.render(R,E)}var y=document.getElementById("tweet-detail-view");y&&r.a.render(S(v,y.dataset),y)}],[[23,1,2]]]);
//# sourceMappingURL=main.763dfa2f.chunk.js.map